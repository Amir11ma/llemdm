<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® Ø¨Ø§Ø²ÛŒ ØªØ±ÛŒØ¯ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazir', 'Tahoma', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0b1120 0%, #1a2639 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #2a3f5e 0%, #1e2a3a 100%);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            border: 1px solid #3a4a6a;
        }

        .header h1 {
            color: #ffd700;
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 0 2px 5px rgba(255,215,0,0.3);
        }

        /* Profile Section */
        .profile-section {
            background: #1e2a3a;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #3a4a6a;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ffd700, #ff9900);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: #1a2639;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .profile-name h3 {
            color: white;
            font-size: 18px;
        }

        .edit-name-btn {
            background: none;
            border: 1px solid #ffd700;
            color: #ffd700;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .edit-name-btn:hover {
            background: #ffd700;
            color: #1a2639;
        }

        .profile-stats {
            display: flex;
            gap: 20px;
            color: #a0b0c0;
            font-size: 14px;
        }

        .profile-stats span {
            color: #ffd700;
            font-weight: bold;
        }

        /* Name Edit Modal */
        .name-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .name-modal-content {
            background: #1e2a3a;
            padding: 25px;
            border-radius: 20px;
            width: 90%;
            max-width: 350px;
            border: 1px solid #ffd700;
            text-align: center;
        }

        .name-modal-content h3 {
            color: #ffd700;
            margin-bottom: 15px;
        }

        .name-input {
            width: 100%;
            padding: 12px;
            background: #0b1120;
            border: 1px solid #3a4a6a;
            border-radius: 10px;
            color: white;
            margin: 15px 0;
            font-size: 16px;
            text-align: center;
        }

        .name-modal-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* Balance Card */
        .balance-card {
            background: linear-gradient(135deg, #1e4b6a 0%, #0f2c40 100%);
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid #2f6a8a;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .balance-card h3 {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
            color: #7fffd4;
        }

        .balance-card .amount {
            font-size: 48px;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 0 2px 10px rgba(255,255,255,0.2);
        }

        .balance-card .label {
            font-size: 14px;
            opacity: 0.7;
        }

        /* Stats Row */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: #1e2a3a;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid #3a4a6a;
        }

        .stat-box .value {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
        }

        .stat-box .title {
            font-size: 13px;
            color: #a0b0c0;
            margin-top: 5px;
        }

        /* Market Prices */
        .section-title {
            color: white;
            font-size: 18px;
            margin: 20px 0 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .price-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .price-card {
            background: #1e2a3a;
            border-radius: 15px;
            padding: 15px;
            border: 1px solid #3a4a6a;
            transition: transform 0.2s;
            cursor: pointer;
        }

        .price-card:hover {
            transform: translateY(-3px);
            border-color: #ffd700;
        }

        .coin-name {
            font-size: 16px;
            font-weight: bold;
            color: white;
            margin-bottom: 5px;
        }

        .coin-symbol {
            color: #7fffd4;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .coin-price {
            font-size: 22px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .coin-change {
            font-size: 14px;
            font-weight: bold;
        }

        .positive { color: #00ff88; }
        .negative { color: #ff4444; }

        /* Portfolio */
        .portfolio-card {
            background: #1e2a3a;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #3a4a6a;
        }

        .portfolio-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #2a3a4a;
        }

        .portfolio-item:last-child {
            border-bottom: none;
        }

        .portfolio-info h4 {
            color: white;
            font-size: 16px;
            margin-bottom: 3px;
        }

        .portfolio-info p {
            color: #a0b0c0;
            font-size: 13px;
        }

        .portfolio-value {
            text-align: left;
        }

        .portfolio-value .amount {
            color: #ffd700;
            font-size: 18px;
            font-weight: bold;
        }

        /* Buttons Grid */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .menu-btn {
            background: #1e2a3a;
            border: 1px solid #3a4a6a;
            border-radius: 12px;
            padding: 12px 5px;
            font-size: 13px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .menu-btn span {
            font-size: 20px;
        }

        .menu-btn:hover {
            background: #2a3f5e;
            border-color: #ffd700;
            transform: scale(1.05);
        }

        .menu-btn.primary {
            background: #ffd700;
            color: #1a2639;
            border-color: #ffd700;
        }

        .menu-btn.primary:hover {
            background: #ffed4a;
        }

        /* AI Analysis */
        .ai-box {
            background: linear-gradient(135deg, #2a1e3a 0%, #1a0f2a 100%);
            border: 1px solid #5a4a7a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .ai-title {
            color: #b794f4;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .trend-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            margin-bottom: 8px;
            color: white;
        }

        .best-buy {
            background: rgba(0,255,0,0.1);
            border: 1px solid #00ff88;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            color: white;
        }

        /* Ranking */
        .ranking-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #1e2a3a;
            border-radius: 12px;
            margin-bottom: 8px;
            border: 1px solid #3a4a6a;
        }

        .rank-number {
            width: 30px;
            height: 30px;
            background: #ffd700;
            color: #1a2639;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .rank-info {
            flex: 1;
            color: white;
        }

        .rank-info h4 {
            font-size: 15px;
            margin-bottom: 3px;
        }

        .rank-info p {
            font-size: 12px;
            color: #a0b0c0;
        }

        .rank-value {
            color: #ffd700;
            font-weight: bold;
        }

        /* Modal for Buy/Sell */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: #1e2a3a;
            padding: 25px;
            border-radius: 20px;
            width: 90%;
            max-width: 350px;
            border: 1px solid #ffd700;
        }

        .modal-content h3 {
            color: #ffd700;
            margin-bottom: 15px;
        }

        .modal-input {
            width: 100%;
            padding: 12px;
            background: #0b1120;
            border: 1px solid #3a4a6a;
            border-radius: 10px;
            color: white;
            margin: 15px 0;
            font-size: 16px;
        }

        .modal-select {
            width: 100%;
            padding: 12px;
            background: #0b1120;
            border: 1px solid #3a4a6a;
            border-radius: 10px;
            color: white;
            margin: 15px 0;
            font-size: 16px;
            cursor: pointer;
        }

        .modal-select option {
            background: #1e2a3a;
            color: white;
        }

        .modal-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* Daily Bonus */
        .bonus-card {
            background: linear-gradient(135deg, #4a3a1a 0%, #2a1e0f 100%);
            border: 1px solid #ffd700;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .bonus-amount {
            font-size: 42px;
            color: #ffd700;
            font-weight: bold;
            margin: 10px 0;
        }

        .bonus-btn {
            background: #ffd700;
            color: #1a2639;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bonus-btn:hover {
            transform: scale(1.05);
            background: #ffed4a;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #00ff88;
            color: #1a2639;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            display: none;
            z-index: 2000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        /* Reset Button */
        .reset-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* Responsive */
        @media (max-width: 500px) {
            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .price-grid {
                grid-template-columns: 1fr;
            }
            
            .profile-section {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ® Ø¨Ø§Ø²ÛŒ ØªØ±ÛŒØ¯ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„</h1>
        </div>

        <!-- Profile Section -->
        <div class="profile-section">
            <div class="profile-avatar" id="avatar">Ø¹</div>
            <div class="profile-info">
                <div class="profile-name">
                    <h3 id="displayName">Ú©Ø§Ø±Ø¨Ø± Ù…Ù‡Ù…Ø§Ù†</h3>
                    <button class="edit-name-btn" onclick="showNameModal()">âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´ Ù†Ø§Ù…</button>
                </div>
                <div class="profile-stats">
                    <div>ØªØ¹Ø¯Ø§Ø¯ ØªØ±ÛŒØ¯: <span id="displayTrades">Û°</span></div>
                </div>
            </div>
        </div>

        <!-- Main Balance -->
        <div class="balance-card">
            <h3>ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„</h3>
            <div class="amount" id="balance">1,000,000</div>
            <div class="label">USDT (ØªØªØ±)</div>
        </div>

        <!-- Stats -->
        <div class="stats-row">
            <div class="stat-box">
                <div class="value" id="totalTrades">Û°</div>
                <div class="title">ØªØ¹Ø¯Ø§Ø¯ ØªØ±ÛŒØ¯Ù‡Ø§</div>
            </div>
            <div class="stat-box">
                <div class="value" id="totalProfit">Û°</div>
                <div class="title">Ø³ÙˆØ¯/Ø²ÛŒØ§Ù† Ú©Ù„</div>
            </div>
        </div>

        <!-- Quick Menu -->
        <div class="menu-grid">
            <button class="menu-btn" onclick="showSection('market')">
                <span>ğŸ“Š</span> Ø¨Ø§Ø²Ø§Ø±
            </button>
            <button class="menu-btn" onclick="showSection('portfolio')">
                <span>ğŸ’°</span> Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§
            </button>
            <button class="menu-btn" onclick="showSection('ai')">
                <span>ğŸ§ </span> Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
            </button>
            <button class="menu-btn" onclick="showSection('ranking')">
                <span>ğŸ†</span> Ø±Ù†Ú©ÛŒÙ†Ú¯
            </button>
            <button class="menu-btn primary" onclick="showBuyModal()">
                <span>ğŸ›’</span> Ø®Ø±ÛŒØ¯
            </button>
            <button class="menu-btn primary" onclick="showSellModal()">
                <span>ğŸ’¸</span> ÙØ±ÙˆØ´
            </button>
            <button class="menu-btn" onclick="dailyBonus()">
                <span>ğŸ</span> Ø¬Ø§ÛŒØ²Ù‡
            </button>
            <button class="menu-btn" onclick="resetGame()">
                <span>ğŸ”„</span> Ø±ÛŒØ³Øª
            </button>
        </div>

        <!-- Market Section -->
        <div id="market" class="section">
            <div class="section-title">
                <span>ğŸ“Š</span> Ø¨Ø§Ø²Ø§Ø± Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ (Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ø±ÙˆÛŒ Ù‡Ø± Ø§Ø±Ø² Ú©Ù„ÛŒÚ© Ú©Ù†)
            </div>
            <div class="price-grid" id="priceGrid"></div>
        </div>

        <!-- Portfolio Section -->
        <div id="portfolio" class="section" style="display: none;">
            <div class="section-title">
                <span>ğŸ’°</span> Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù†
            </div>
            <div class="portfolio-card" id="portfolioList">
                <div style="color: #a0b0c0; text-align: center; padding: 20px;">
                    Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ù†Ø¯Ø§Ø±ÛŒ! Ø§Ø² Ø¯Ú©Ù…Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.
                </div>
            </div>
        </div>

        <!-- AI Section -->
        <div id="ai" class="section" style="display: none;">
            <div class="ai-box">
                <div class="ai-title">
                    <span>ğŸ§ </span> ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
                </div>
                <div id="aiAnalysis"></div>
            </div>
        </div>

        <!-- Ranking Section -->
        <div id="ranking" class="section" style="display: none;">
            <div class="section-title">
                <span>ğŸ†</span> Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† (Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ ØªØ±ÛŒØ¯)
            </div>
            <div id="rankingList"></div>
        </div>

        <!-- Daily Bonus Card -->
        <div class="bonus-card">
            <div>ğŸ Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡</div>
            <div class="bonus-amount">Ûµ,Û°Û°Û°</div>
            <div>USDT</div>
            <button class="bonus-btn" onclick="dailyBonus()">Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø§ÛŒØ²Ù‡</button>
        </div>

        <!-- Name Edit Modal -->
        <div class="name-modal" id="nameModal">
            <div class="name-modal-content">
                <h3>âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´ Ù†Ø§Ù…</h3>
                <input type="text" class="name-input" id="newName" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" maxlength="20">
                <div class="name-modal-buttons">
                    <button class="bonus-btn" onclick="saveName()">âœ… Ø°Ø®ÛŒØ±Ù‡</button>
                    <button class="bonus-btn" style="background: #ff4444;" onclick="closeNameModal()">âŒ Ù„ØºÙˆ</button>
                </div>
            </div>
        </div>

        <!-- Buy Modal -->
        <div class="modal" id="buyModal">
            <div class="modal-content">
                <h3>ğŸ›’ Ø®Ø±ÛŒØ¯ Ø§Ø±Ø²</h3>
                <select class="modal-select" id="buyCoin">
                    <option value="BTC">Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† (BTC)</option>
                    <option value="ETH">Ø§ØªØ±ÛŒÙˆÙ… (ETH)</option>
                    <option value="BNB">Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ† (BNB)</option>
                    <option value="SOL">Ø³ÙˆÙ„Ø§Ù†Ø§ (SOL)</option>
                </select>
                <input type="number" class="modal-input" id="buyAmount" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" step="0.001">
                <div class="modal-buttons">
                    <button class="bonus-btn" onclick="buyCoin()">âœ… Ø®Ø±ÛŒØ¯</button>
                    <button class="bonus-btn" style="background: #ff4444;" onclick="closeModal('buyModal')">âŒ Ù„ØºÙˆ</button>
                </div>
            </div>
        </div>

        <!-- Sell Modal -->
        <div class="modal" id="sellModal">
            <div class="modal-content">
                <h3>ğŸ’¸ ÙØ±ÙˆØ´ Ø§Ø±Ø²</h3>
                <select class="modal-select" id="sellCoin"></select>
                <input type="number" class="modal-input" id="sellAmount" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" step="0.001">
                <div class="modal-buttons">
                    <button class="bonus-btn" onclick="sellCoin()">âœ… ÙØ±ÙˆØ´</button>
                    <button class="bonus-btn" style="background: #ff4444;" onclick="closeModal('sellModal')">âŒ Ù„ØºÙˆ</button>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div class="toast" id="toast"></div>
    </div>

    <script>
        // Game State - Ù‡Ù…Ù‡ Ú†ÛŒØ² ØªÙˆ localStorage Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒØ´Ù‡
        let balance = 1000000;
        let portfolio = {};
        let prices = {};
        let lastDaily = null;
        let trades = 0;
        let profit = 0;
        let userName = "Ú©Ø§Ø±Ø¨Ø± Ù…Ù‡Ù…Ø§Ù†";

        // Load saved data
        function loadGame() {
            try {
                let saved = localStorage.getItem('cryptoGame');
                if (saved) {
                    let data = JSON.parse(saved);
                    balance = data.balance || 1000000;
                    portfolio = data.portfolio || {};
                    trades = data.trades || 0;
                    profit = data.profit || 0;
                    userName = data.userName || "Ú©Ø§Ø±Ø¨Ø± Ù…Ù‡Ù…Ø§Ù†";
                    lastDaily = data.lastDaily || null;
                }
            } catch (e) {
                console.log('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ:', e);
            }
            
            updateDisplay();
            updateAvatar();
        }

        // Save game data (ÙÙ‚Ø· Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØºÛŒØ± Ø­Ø³Ø§Ø³)
        function saveGame() {
            let data = {
                balance: balance,
                portfolio: portfolio,
                trades: trades,
                profit: profit,
                userName: userName,
                lastDaily: lastDaily
            };
            localStorage.setItem('cryptoGame', JSON.stringify(data));
        }

        // Reset game
        function resetGame() {
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ Ù‡Ù…Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø§Ú© Ù…ÛŒØ´Ù‡ Ùˆ Û± Ù…ÛŒÙ„ÛŒÙˆÙ† Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯Ù‡!')) {
                balance = 1000000;
                portfolio = {};
                trades = 0;
                profit = 0;
                lastDaily = null;
                saveGame();
                updateDisplay();
                updateAIAnalysis();
                showToast('ğŸ”„ Ø¨Ø§Ø²ÛŒ Ø±ÛŒØ³Øª Ø´Ø¯! Û±,Û°Û°Û°,Û°Û°Û° USDT Ø¨Ø±Ú¯Ø´Øª.');
            }
        }

        // Name management
        function showNameModal() {
            document.getElementById('newName').value = userName;
            document.getElementById('nameModal').style.display = 'flex';
        }

        function closeNameModal() {
            document.getElementById('nameModal').style.display = 'none';
        }

        function saveName() {
            let newName = document.getElementById('newName').value.trim();
            if (newName) {
                userName = newName;
                updateAvatar();
                saveGame();
                showToast('âœ… Ù†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯!');
            }
            closeNameModal();
        }

        function updateAvatar() {
            document.getElementById('displayName').innerText = userName;
            let firstChar = userName.charAt(0);
            document.getElementById('avatar').innerText = firstChar;
        }

        // Initialize
        window.onload = function() {
            loadGame();
            updatePrices();
            startPriceUpdates();
            generateRanking();
            updateAIAnalysis();
        };

        // Update Prices
        function updatePrices() {
            prices = {
                BTC: { name: 'Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†', price: 63245 + Math.random() * 1000 - 500, change: (Math.random() * 6 - 3).toFixed(1) },
                ETH: { name: 'Ø§ØªØ±ÛŒÙˆÙ…', price: 3567 + Math.random() * 100 - 50, change: (Math.random() * 6 - 3).toFixed(1) },
                BNB: { name: 'Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ†', price: 567 + Math.random() * 20 - 10, change: (Math.random() * 6 - 3).toFixed(1) },
                SOL: { name: 'Ø³ÙˆÙ„Ø§Ù†Ø§', price: 156 + Math.random() * 10 - 5, change: (Math.random() * 6 - 3).toFixed(1) }
            };
            
            displayPrices();
        }

        function displayPrices() {
            let html = '';
            for (let [symbol, data] of Object.entries(prices)) {
                html += `
                    <div class="price-card" onclick="quickBuy('${symbol}')">
                        <div class="coin-name">${data.name}</div>
                        <div class="coin-symbol">${symbol}</div>
                        <div class="coin-price">$${Math.round(data.price).toLocaleString()}</div>
                        <div class="coin-change ${data.change >= 0 ? 'positive' : 'negative'}">
                            ${data.change >= 0 ? '+' : ''}${data.change}%
                        </div>
                    </div>
                `;
            }
            document.getElementById('priceGrid').innerHTML = html;
        }

        // Quick buy from market
        function quickBuy(symbol) {
            document.getElementById('buyCoin').value = symbol;
            showBuyModal();
        }

        // Show Section
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
            document.getElementById(section).style.display = 'block';
            
            if (section === 'ranking') {
                generateRanking();
            }
        }

        // Update Display
        function updateDisplay() {
            document.getElementById('balance').innerText = balance.toLocaleString();
            document.getElementById('totalTrades').innerText = trades;
            document.getElementById('displayTrades').innerText = trades;
            document.getElementById('totalProfit').innerText = profit.toLocaleString();
            updatePortfolio();
        }

        // Portfolio
        function updatePortfolio() {
            if (Object.keys(portfolio).length === 0) {
                document.getElementById('portfolioList').innerHTML = 
                    '<div style="color: #a0b0c0; text-align: center; padding: 20px;">Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ù†Ø¯Ø§Ø±ÛŒ! Ø§Ø² Ø¯Ú©Ù…Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†.</div>';
                return;
            }

            let html = '';
            let totalValue = 0;
            
            for (let [symbol, amount] of Object.entries(portfolio)) {
                if (prices[symbol]) {
                    let value = amount * prices[symbol].price;
                    totalValue += value;
                    html += `
                        <div class="portfolio-item">
                            <div class="portfolio-info">
                                <h4>${prices[symbol].name}</h4>
                                <p>${amount.toFixed(4)} ${symbol}</p>
                            </div>
                            <div class="portfolio-value">
                                <div class="amount">$${Math.round(value).toLocaleString()}</div>
                            </div>
                        </div>
                    `;
                }
            }
            
            html += `
                <div style="margin-top: 15px; padding-top: 15px; border-top: 2px solid #ffd700;">
                    <div style="display: flex; justify-content: space-between; color: white;">
                        <span>ğŸ’ Ù…Ø¬Ù…ÙˆØ¹ Ø¯Ø§Ø±Ø§ÛŒÛŒ:</span>
                        <span style="color: #ffd700;">$${Math.round(totalValue).toLocaleString()}</span>
                    </div>
                </div>
            `;
            
            document.getElementById('portfolioList').innerHTML = html;
            
            // Update sell dropdown
            updateSellDropdown();
        }

        // Update sell dropdown
        function updateSellDropdown() {
            let select = document.getElementById('sellCoin');
            if (!select) return;
            
            let options = '';
            for (let [symbol, amount] of Object.entries(portfolio)) {
                if (prices[symbol]) {
                    options += `<option value="${symbol}">${prices[symbol].name} (${symbol}) - Ù…ÙˆØ¬ÙˆØ¯ÛŒ: ${amount.toFixed(4)}</option>`;
                }
            }
            select.innerHTML = options;
        }

        // Buy/Sell Modals
        function showBuyModal() {
            document.getElementById('buyModal').style.display = 'flex';
        }

        function showSellModal() {
            if (Object.keys(portfolio).length === 0) {
                showToast('âŒ Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ÙØ±ÙˆØ´ Ù†Ø¯Ø§Ø±ÛŒ!');
                return;
            }
            updateSellDropdown();
            document.getElementById('sellModal').style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function buyCoin() {
            let coin = document.getElementById('buyCoin').value;
            let amount = parseFloat(document.getElementById('buyAmount').value);
            
            if (!amount || amount <= 0) {
                showToast('âŒ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†!');
                return;
            }
            
            let cost = amount * prices[coin].price;
            
            if (cost > balance) {
                showToast(`âŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª! Ù†ÛŒØ§Ø²: $${Math.round(cost).toLocaleString()}`);
                return;
            }
            
            balance -= cost;
            portfolio[coin] = (portfolio[coin] || 0) + amount;
            trades++;
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÙˆØ¯/Ø²ÛŒØ§Ù† ØªÙ‚Ø±ÛŒØ¨ÛŒ
            if (prices[coin].change > 0) {
                profit += amount * prices[coin].price * 0.01;
            }
            
            saveGame();
            showToast(`âœ… ${amount} ${coin} Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯`);
            closeModal('buyModal');
            updateDisplay();
            updateAIAnalysis();
            document.getElementById('buyAmount').value = '';
        }

        function sellCoin() {
            let coin = document.getElementById('sellCoin').value;
            let amount = parseFloat(document.getElementById('sellAmount').value);
            
            if (!amount || amount <= 0) {
                showToast('âŒ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†!');
                return;
            }
            
            if (!portfolio[coin] || portfolio[coin] < amount) {
                showToast(`âŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª! Ø­Ø¯Ø§Ú©Ø«Ø±: ${portfolio[coin]?.toFixed(4) || 0} ${coin}`);
                return;
            }
            
            let value = amount * prices[coin].price;
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†
            if (prices[coin].change < 0) {
                profit -= amount * prices[coin].price * 0.005;
            } else {
                profit += amount * prices[coin].price * 0.005;
            }
            
            balance += value;
            portfolio[coin] -= amount;
            trades++;
            
            if (portfolio[coin] <= 0) {
                delete portfolio[coin];
            }
            
            saveGame();
            showToast(`âœ… ${amount} ${coin} ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯ +$${Math.round(value).toLocaleString()}`);
            closeModal('sellModal');
            updateDisplay();
            updateAIAnalysis();
            document.getElementById('sellAmount').value = '';
        }

        // Daily Bonus
        function dailyBonus() {
            let now = new Date().toDateString();
            if (lastDaily === now) {
                showToast('â° Ø¬Ø§ÛŒØ²Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯Ù‡! ÙØ±Ø¯Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨ÛŒØ§.');
                return;
            }
            
            balance += 5000;
            lastDaily = now;
            saveGame();
            showToast('ğŸ Ûµ,Û°Û°Û° USDT Ø¨Ù‡ Ø­Ø³Ø§Ø¨Øª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!');
            updateDisplay();
        }

        // AI Analysis
        function updateAIAnalysis() {
            if (!prices.BTC) return;
            
            let bestCoin = Object.entries(prices).reduce((a, b) => 
                parseFloat(a[1].change) > parseFloat(b[1].change) ? a : b
            );
            
            let worstCoin = Object.entries(prices).reduce((a, b) => 
                parseFloat(a[1].change) < parseFloat(b[1].change) ? a : b
            );
            
            let html = `
                <div class="trend-item">
                    <span>ğŸ“Š Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†:</span>
                    <span class="${prices.BTC.change >= 0 ? 'positive' : 'negative'}">
                        ${prices.BTC.change >= 0 ? 'ØµØ¹ÙˆØ¯ÛŒ ğŸ“ˆ' : 'Ù†Ø²ÙˆÙ„ÛŒ ğŸ“‰'}
                    </span>
                </div>
                <div class="trend-item">
                    <span>ğŸ“Š Ø§ØªØ±ÛŒÙˆÙ…:</span>
                    <span class="${prices.ETH.change >= 0 ? 'positive' : 'negative'}">
                        ${prices.ETH.change >= 0 ? 'ØµØ¹ÙˆØ¯ÛŒ ğŸ“ˆ' : 'Ù†Ø²ÙˆÙ„ÛŒ ğŸ“‰'}
                    </span>
                </div>
                <div class="trend-item">
                    <span>ğŸ“Š Ø¨Ø§ÛŒÙ†Ù†Ø³:</span>
                    <span class="${prices.BNB.change >= 0 ? 'positive' : 'negative'}">
                        ${prices.BNB.change >= 0 ? 'ØµØ¹ÙˆØ¯ÛŒ ğŸ“ˆ' : 'Ù†Ø²ÙˆÙ„ÛŒ ğŸ“‰'}
                    </span>
                </div>
                <div class="trend-item">
                    <span>ğŸ“Š Ø³ÙˆÙ„Ø§Ù†Ø§:</span>
                    <span class="${prices.SOL.change >= 0 ? 'positive' : 'negative'}">
                        ${prices.SOL.change >= 0 ? 'ØµØ¹ÙˆØ¯ÛŒ ğŸ“ˆ' : 'Ù†Ø²ÙˆÙ„ÛŒ ğŸ“‰'}
                    </span>
                </div>
                <div class="best-buy">
                    <p>âœ… <b>Ø¨Ù‡ØªØ±ÛŒÙ† Ú¯Ø²ÛŒÙ†Ù‡ Ø®Ø±ÛŒØ¯:</b> ${bestCoin[1].name} Ø¨Ø§ Ø±Ø´Ø¯ ${bestCoin[1].change}%</p>
                    <p>âš ï¸ <b>Ù‡Ø´Ø¯Ø§Ø± ÙØ±ÙˆØ´:</b> ${worstCoin[1].name} Ø¨Ø§ Ú©Ø§Ù‡Ø´ ${worstCoin[1].change}%</p>
                    <p>ğŸ’° <b>Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯:</b> Ø®Ø±ÛŒØ¯ ${balance > 50000 ? 'Û±Û°Û°Û°' : 'Û±Û°Û°'} ${bestCoin[0]}</p>
                </div>
            `;
            
            document.getElementById('aiAnalysis').innerHTML = html;
        }

        // Ranking - ÙÙ‚Ø· Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ ØªØ±ÛŒØ¯
        function generateRanking() {
            // Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø² localStorage Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ùˆ Ù…ÛŒØ®ÙˆÙ†ÛŒÙ… (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´)
            let allUsers = [];
            
            try {
                // Ø³Ø¹ÛŒ Ù…ÛŒÚ©Ù†ÛŒÙ… Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯ÛŒÚ¯Ù‡ Ø±Ùˆ Ù‡Ù… Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒÙ…
                for (let i = 0; i < localStorage.length; i++) {
                    let key = localStorage.key(i);
                    if (key && key.startsWith('cryptoGame_')) {
                        try {
                            let data = JSON.parse(localStorage.getItem(key));
                            allUsers.push({
                                name: data.userName || 'Ù†Ø§Ø´Ù†Ø§Ø³',
                                trades: data.trades || 0
                            });
                        } catch (e) {}
                    }
                }
            } catch (e) {}
            
            // Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ Ø±Ùˆ Ù‡Ù… Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
            allUsers.push({
                name: userName,
                trades: trades
            });
            
            // Ù…Ø±ØªØ¨ Ø³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ ØªØ±ÛŒØ¯
            allUsers.sort((a, b) => b.trades - a.trades);
            
            // ÙÙ‚Ø· Û±Û° ØªØ§ Ø±Ùˆ Ù†Ø´ÙˆÙ† Ø¨Ø¯Ù‡
            allUsers = allUsers.slice(0, 10);
            
            let html = '';
            allUsers.forEach((user, index) => {
                if (user.trades > 0) {
                    html += `
                        <div class="ranking-item">
                            <div class="rank-number">${index + 1}</div>
                            <div class="rank-info">
                                <h4>${user.name}</h4>
                                <p>${user.trades} ØªØ±ÛŒØ¯</p>
                            </div>
                            <div class="rank-value">â­</div>
                        </div>
                    `;
                }
            });
            
            if (!html) {
                html = '<div style="color: #a0b0c0; text-align: center; padding: 20px;">Ù‡Ù†ÙˆØ² Ú©Ø³ÛŒ ØªØ±ÛŒØ¯ Ù†Ú©Ø±Ø¯Ù‡! ØªÙˆ Ø§ÙˆÙ„ÛŒÙ† Ù†ÙØ± Ø¨Ø§Ø´ ğŸš€</div>';
            }
            
            document.getElementById('rankingList').innerHTML = html;
        }

        // Toast
        function showToast(message) {
            let toast = document.getElementById('toast');
            toast.style.display = 'block';
            toast.innerText = message;
            setTimeout(() => {
                toast.style.display = 'none';
            }, 2000);
        }

        // Price Updates
        function startPriceUpdates() {
            setInterval(() => {
                updatePrices();
                updatePortfolio();
                updateAIAnalysis();
            }, 5000);
        }

        // Save on beforeunload
        window.addEventListener('beforeunload', function() {
            saveGame();
        });
    </script>
</body>
</html>
